
Import-Module activedirectory

function Send-SlackMessage {
    # Add the "Incoming WebHooks" integration to get started: https://slack.com/apps/A0F7XDUAZ-incoming-webhooks
    param (
        [Parameter(Mandatory=$true, Position=0)]$Text,
        $Url="https://hooks.slack.com/services/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", #Put your URL here so you don't have to specify it every time.
        # Parameters below are optional and will fall back to the default setting for the webhook.
        $Username, # Username to send from.
        $Channel, # Channel to post message. Can be in the format "@username" or "#channel"
        $Emoji, # Example: ":bangbang:".
        $IconUrl # Url for an icon to use.
    )

    $body = @{ text=$Text; channel=$Channel; username=$Username; icon_emoji=$Emoji; icon_url=$IconUrl } | ConvertTo-Json
    Invoke-WebRequest -Method Post -Uri $Url -Body $body
}

## this script is running on HQIT02 as a scheduled task. ##a

#$script:users = Get-ADUser -Filter {Name -like "*constan*"} -Properties *| select name -ExpandProperty name
$script:lockedUsers = Search-ADAccount -LockedOut | select SAMAccountName -ExpandProperty SAMAccountName
$currentTime = (get-date).ToString("HHmm")

<#
$emojis = @(
":thumbsup:",
":fire:",
":partydino:",
":partyparrot:",
":cat:",
":nyan-cat:",
":scream_cat:",
":payscalien-scott:",
":unicorn_face:",
":payscalien-mike:",
":partyparrotshuffle:",
":parrotbeer:",
":awyeahhh:",
":epic-sax-guy:",
":heres_johnny:",
":heavy-breathing:",
":ash:",
":awkward_turtle:",
":ayylmao:",
":sad-panda:",
":violin_tiny:",
":tiefighter:",
":grumpy-cat:",
":shipitparrot:",
":shia:",
":shipit:",
":doge:",
":doge3d:",
":donald_trump:",
":doh:",
":dealwithitparrot:",
":business-cat:",
":captainplanet:",
":carlton:",
":dancingpanda:",
":chandler_dance:",
":panda_dance:",
":dancing_corgi:",
":snoop_dancing:",
":parrot_dad:",
":peanut_butter_jelly_time:",
":bueller:",
":badgerbadger:",
":badpundog:",
":cool_beans:",
":bouncytotoro:",
":bob_ross:",
":pusheen-bread:",
":celeryman:",
":chadross:",
":chewbacca:",
":glitch_crab:",
":cthulhu:",
":fire: :bacon:",
":success-kid:",
":kirby:",
":yoga:",
":mojito:",
":mario2:",
":mario:",
":mario1:",
":manatee:",
":jim:",
":hackday:",
":payscale-it:",
":sadparrot:",
":homer-disappear:",
":social_media_dinosaur:",
":beepboop:",
":eazye:",
":elephant:",
":esteban:",
":half-esteban:",
":hear_no_evil:",
":see_no_evil:",
":speak_no_evil:",
":evil:",
":excellent:",
":explodyparrot:",
":facepalm:",
":force-choke:",
":frenchie:",
":icecreamparrot:",
":fiestaparrot:",
":parrotcop:",
":skiparrot:",
":data-corn:",
":sonic:",
":toof_is_sad:",
":unicorn_face:",
":fix-it_felix:",
":fidget:",
":george:",
":glitch_crab:",
":glowstick:",
":goat:",
":goomba:",
":no-good:",
":grimacing:",
":guinea-pig:",
":hamburgler:",
":hahabusiness:",
":hammer_time:",
":hadouken:",
":hali:",
":spock-hand:",
":hulkhogan:",
":idaho:",
":itslit:",
":jarjarbinks:",
":kanye:",
":koala:",
":krabby:",
":la-croix-grapefruit:",
":la-croix-lemon:",
":la-croix-lime:",
":letsplay:",
":t-rex-team-left:",
":lit:",
":lumberg:",
":pineapple:",
":thonkingggg:",
":totoro:",
":totorohoop:", 
":waiting:",
":adam:",
":black-disco-ball:",
":buggy:",
":dat-boi:",
":deathstar2:", 
":angry_trump:", 
":autobots:", 
":aww-yiss:",
":babypanther:",
":bender:",
":bernie_sanders:",
":betterghost:",
":bettlejuice:",
":binary:",
":bitcoin:",
":black-disco-ball:",
":black_panther:",
":blueranger:",
":boris:",
":bye_boo:",
":cage:",
":captainamerica:",
":car-t-rex:",
":car-team:",
":cassidy:",
":chili:",
":consumer_marketing:",
":corgi:",
":covfefe:",
":cry_rainbow_tears:",
":cubone:",
":curling:",
":data-corn:",
":data-science:",
":dead:",
":donatello:",
":donkey:",
":drevil:",
":dumpsterfire:",
":dumpling_bun:",
":fiestiaparrot:",
":fist-shake:",
":flamingo:",
":flipflop:",
":frenchie:",
":fsm:",
":garret:",
":george:",
":great_lakes:",
":greatsuccess:",
":greenman:",
":grooming:",
":grumpybaby:",
":guitarcenter:",
":hali:",
":hillary_clinton:",
":hodor:",
":hypno_spiral:",
":insightdown:",
":java:",
":left_shark:",
":limabean:",
":mac:",
":mary-jane:",
":megaman:",
":monkeyy:",
":moose:",
":ms:",
":mysterymachine:"

)
#> #big ol' emoji list. replacing with file with all emojis
#$emojis = gc "\\filer02\IT\zz_aconstantino\EmojisFinal.txt" #you need to pull out the commas from the txt to use this.
#also adding every single emoji into this script seems to be much faster

$emojis = @(
":bowtie:",
":squirrel:",
":glitch_crab:",
":piggy:",
":cubimal_chick:",
":dusty_stick:",
":slack:",
":pride:",
":thumbsup_all:",
":slack_call:",
":shipit:",
":white_square:",
":black_square:",
":simple_smile:",
":neckbeard:",
":metal:",
":fu:",
":feelsgood:",
":finnadie:",
":goberserk:",
":godmode:",
":hurtrealbad:",
":rage1:",
":rage2:",
":rage3:",
":rage4:",
":suspect:",
":trollface:",
":octocat:",
":beryl:",
":rube:",
":troll:",
":super:",
":t-rex-team:",
":car-team:",
":fingerscrossed:",
":margarita:",
":chewie:",
":doge:",
":nyan-cat:",
":imnotyourbuddyguy:",
":grumpy-cat:",
":chowdah:",
":cthulhu:",
":kraken:",
":joffrey:",
":joffrey1:",
":rapids:",
":seahawks:",
":broncos:",
":mind-blown:",
":illuminati:",
":successcrushers:",
":stark:",
":marketpay:",
":payscale:",
":paypay:",
":howler:",
":grooming:",
":idaho:",
":lemonade:",
":pusheen-love:",
":pusheen-bread:",
":pusheen-tap:",
":pusheen-chips:",
":pusheen-pizza:",
":pusheen-fuu:",
":pusheen-baker:",
":salena:",
":sarcasm:",
":sarcastic:",
":la-croix-lime:",
":la-croix-grapefruit:",
":la-croix-lemon:",
":corgi:",
":empress:",
":cassidy:",
":bourbon_rocks:",
":bottle_of_whiskey:",
":huzzah:",
":welcome:",
":awyeah:",
":drone:",
":jarjarbinks:",
":bobafett:",
":c3po:",
":chewbacca:",
":deathstar:",
":deathstar2:",
":milleniumfalcon:",
":r2d2:",
":tiefighter:",
":stormtrooper:",
":xwing:",
":yoda:",
":ywing:",
":mic_drop:",
":irish_car_bomb:",
":esteban:",
":half-esteban:",
":10seconds:",
":5seconds:",
":bahn-mi:",
":social_media_dinosaur:",
":batman:",
":bettlejuice:",
":blueranger:",
":donatello:",
":hulk:",
":ironman:",
":joker:",
":captainamerica:",
":captainplanet:",
":leonardo:",
":michelangelo:",
":raphael:",
":redranger:",
":robin:",
":superman:",
":splinter:",
":thor:",
":wolverine:",
":sad-panda:",
":mariners:",
":baelish:",
":epsom_salt:",
":1up:",
":all_the_things:",
":amazon:",
":angry_trump:",
":appleinc:",
":bernie_sanders:",
":bob_ross:",
":bulbasaur:",
":chandler_dance:",
":carlton:",
":charizard:",
":charmander:",
":cheese:",
":clapping:",
":coin:",
":deadmau5:",
":ditto:",
":donald_trump:",
":drake:",
":drool:",
":evil:",
":excellent:",
":eyeroll:",
":facebook:",
":facedesk:",
":facepalm:",
":fingers_crossed:",
":flag_on_the_play:",
":flames:",
":flying_money_with_wings:",
":glowstick:",
":goomba:",
":grumpycat:",
":hadouken:",
":hahabusiness:",
":hammer_time:",
":happening:",
":hillary_clinton:",
":hipster_oversized_glasses:",
":hodor:",
":homer-disappear:",
":honeybadger:",
":humpday:",
":ivysaur:",
":kirby:",
":kylo_ren:",
":left_shark:",
":lol:",
":mario:",
":mario-block:",
":mew:",
":mewtwo:",
":mindblown:",
":n64:",
":narwhal:",
":netflix:",
":notbad:",
":nyancat_big:",
":ohyeah:",
":panic_button:",
":partyparrot:",
":peanut_butter_jelly_time:",
":peekaboo:",
":phasma:",
":philosoraptor:",
":picard-why:",
":pikachu:",
":pizza_party:",
":pokeball:",
":powerup:",
":psyduck:",
":rock:",
":scotch:",
":shia:",
":slow_clap:",
":snoop_dancing:",
":snorlax:",
":sonic:",
":spotify:",
":squirtle:",
":starbucks:",
":success-kid:",
":take_my_money:",
":the_more_you_know:",
":travolta:",
":trump_hair:",
":tumbleweed:",
":twitter:",
":two-cents:",
":watch_out:",
":whoa:",
":why_not_both:",
":windows:",
":wololo:",
":woohoo:",
":word:",
":yeti:",
":yoshi:",
":questionblock:",
":mario1:",
":mario2:",
":megaman:",
":greatsuccess:",
":tyrion:",
":cerseiwine:",
":margery:",
":cubuffalo:",
":jackie-wtf:",
":fiddleofgold:",
":doh:",
":scrooge:",
":georgerrmartin:",
":winning:",
":eduardo:",
":fiestaparrot:",
":explodyparrot:",
":partyparrotshuffle:",
":parrotcop:",
":panda_dance:",
":dealwithitparrot:",
":icecreamparrot:",
":manatee:",
":tinfoilhat:",
":afterpartyparrot:",
":sadparrot:",
":pickle:",
":canttakeit:",
":mj:",
":tupac:",
":chad:",
":pizzakid:",
":gucci:",
":uhh:",
":jim:",
":totorohoop:",
":awkward_turtle:",
":boost:",
":kanye:",
":prayerhands:",
":bunny:",
":chocoswirl:",
":crewish:",
":rowing:",
":donkey:",
":poppinbottles:",
":quagmire:",
":suh:",
":drizzy:",
":bae:",
":larry:",
":george:",
":ms:",
":whipurhair:",
":goodgood:",
":thereisnobathroom:",
":itsatrap:",
":mexicochad:",
":turtlenick:",
":tacochad:",
":unicornrainbows:",
":chefboyarchad:",
":youshallnotpass:",
":rage_against:",
":fist-shake:",
":crickets:",
":blueheart:",
":orangeheart:",
":tardis:",
":exterminate:",
":black-disco-ball:",
":disco-gru:",
":disco-purple2:",
":soul-train:",
":ppg-blossom:",
":ppg-bubbles:",
":ppg-buttercup:",
":ppg-mojo:",
":ironman-mask:",
":wesley:",
":s_h_i_e_l_d:",
":avengers:",
":green_lantern:",
":ironman_mask:",
":deadpool:",
":communicator:",
":ohm:",
":star_trek:",
":star-trek:",
":enterprise:",
":blossom2:",
":fireworks_burst:",
":fireworks-red:",
":moose:",
":epic-splits:",
":guccimane:",
":discoball:",
":discoball2:",
":seizure:",
":trippycat:",
":pokeballgif:",
":lit:",
":itslit:",
":picachu:",
":chadross:",
":burrito-wing:",
":adp:",
":dat-boi:",
":mary-jane:",
":gengar:",
":ash:",
":teamrocket:",
":oh-yeah:",
":kanyehow:",
":chadbieber:",
":palpatine:",
":force-choke:",
":stay-classy:",
":flipflop:",
":ballot_box:",
":babypanthers:",
":babypanther:",
":consumer_marketing:",
":valor:",
":instinct:",
":mystic:",
":lumberg:",
":salad:",
":piedpiper:",
":work_it:",
":juno:",
":flash:",
":oregontrail:",
":woodchipper:",
":woodchipper-red:",
":milkfrother:",
":mushroomcloud:",
":cloyster:",
":dewgong:",
":diglett:",
":doduo:",
":dratini:",
":dodrio:",
":dugtrio:",
":ekans:",
":electabuzz:",
":exeggcute:",
":exeggutor:",
":fearow:",
":flareon:",
":gastly:",
":geodude:",
":gloom:",
":golbat:",
":goldeen:",
":golduck:",
":golem:",
":graveler:",
":grimer:",
":hitmonlee:",
":horsea:",
":haunter:",
":hypno:",
":jigglypuff:",
":jolteon:",
":jynx:",
":kabuto:",
":kabutops:",
":kadabra:",
":kingler:",
":koffing:",
":krabby:",
":lapras:",
":lickitung:",
":machamp:",
":machoke:",
":machop:",
":magikarp:",
":magmar:",
":magnemite:",
":magneton:",
":mankey:",
":marowak:",
":meowth:",
":moltres:",
":mr_mime:",
":muk:",
":nidoking:",
":nidorina:",
":ninetales:",
":omanyte:",
":omastar:",
":paras:",
":parasect:",
":persian:",
":pidgeot:",
":poliwag:",
":poliwhirl:",
":poliwrath:",
":ponyta:",
":porygon:",
":primeape:",
":raichu:",
":raticate:",
":rattata:",
":rhydon:",
":sandshrew:",
":sandslash:",
":seadra:",
":seaking:",
":seel:",
":shellder:",
":slowbro:",
":slowpoke:",
":spearow:",
":starmie:",
":tangela:",
":tauros:",
":tentacool:",
":tentacruel:",
":vaporeon:",
":venomoth:",
":venonat:",
":venusaur:",
":victreebel:",
":vileplume:",
":voltorb:",
":vulpix:",
":weepinbell:",
":weezing:",
":wigglytuff:",
":abra:",
":aerodactyl:",
":alakazam:",
":arcanine:",
":bellsprout:",
":zapdos:",
":zubat:",
":butterfree:",
":chansey:",
":charmeleon:",
":clefable:",
":caterpie:",
":clefairy:",
":cubone:",
":dragonair:",
":dragonite:",
":drowzee:",
":eevee:",
":electrode:",
":farfetchd:",
":growlithe:",
":gyarados:",
":hitmonchan:",
":kakuna:",
":kangaskhan:",
":metapod:",
":nidoqueen:",
":nidoran_f:",
":nidorino:",
":nidoran_m:",
":oddish:",
":onix:",
":pidgeotto:",
":pidgey:",
":pinsir:",
":rapidash:",
":rhyhorn:",
":scyther:",
":staryu:",
":wartortle:",
":weedle:",
":arbok:",
":beedrill:",
":articuno:",
":blastoise:",
":strangerthings:",
":puttputt-roary:",
":piratechad:",
":godawgs:",
":log:",
":pokechad:",
":chadketchum:",
":tots:",
":demskis:",
":dewan2016:",
":praying-mantis:",
":mantis-shrimp:",
":worm:",
":core:",
":dancing_corgi:",
":seahawkslogo:",
":rw3:",
":bambamcam:",
":sherman:",
":easteregg:",
":qbert:",
":twilight:",
":mysterymachine:",
":partymantis:",
":goldstar:",
":redstar:",
":bluestar:",
":greenstar:",
":purplestar:",
":lordbusiness:",
":drooldrool:",
":caffeine:",
":aloevera:",
":parrot_dad:",
":watson:",
":whiny_baby:",
":harambe:",
":soda:",
":classyjorts:",
":sassyjorts:",
":80sphone:",
":triggered:",
":parrot_shuffle_further:",
":right-mantis:",
":baristachad:",
":rainierbeer:",
":rainierlogo:",
":elmerfudd:",
":lions:",
":babychad:",
":stillers:",
":ashley:",
":doberman:",
":bowdown:",
":stephcurry:",
":kobe:",
":klaythompson:",
":klaythompson1:",
":broseph:",
":salty:",
":teleprompter:",
":smores:",
":bush:",
":mantis-gold:",
":mantis-red:",
":mantis-green:",
":mantis-blue:",
":mantis-purple:",
":rilakkuma:",
":rilakkuma-happy:",
":ironthrone:",
":l:",
":lll:",
":mustache:",
":fsm:",
":worksonmymachine:",
":drevil:",
":saltyyy:",
":arthurfist:",
":snap_specs:",
":dragonslaying-jim:",
":under_the_bus:",
":otter:",
":dobby:",
":salesforce:",
":haveaseat:",
":dead:",
":oooh:",
":ehhh:",
":huh:",
":uhoh:",
":shaq:",
":mindblownn:",
":cosby:",
":ooooh:",
":fredo:",
":yeshrug:",
":blessed:",
":cringe:",
":khaled:",
":ld:",
":trashh:",
":lesabre:",
":chadscale:",
":doubleblacks:",
":blackdiamond:",
":bluesquare:",
":oompaloompa:",
":numberone:",
":kwe:",
":bueller:",
":chadkeeper:",
":inspector:",
":beepboop:",
":badgerbadger:",
":holdup:",
":charlie:",
":this-is-fine:",
":memberberry:",
":mojito:",
":pug:",
":beaver:",
":harry:",
":chandler:",
":fix-it_felix:",
":corndog:",
":ravenclaw:",
":slytherin:",
":gryffindor:",
":hufflepuff:",
":oooo:",
":obamaa:",
":iceberg:",
":getoffmylawn:",
":nospam:",
":spam:",
":boomstick:",
":x-files:",
":t-rex-team-left:",
":turkeytwerk:",
":guinea-pig:",
":dawgs:",
":adam:",
":chadclaus:",
":sadtrombone:",
":robacado:",
":htc_vive:",
":merge:",
":hopping_rainbow:",
":ninja:",
":hali:",
":friday:",
":lindensaurus:",
":lindensaurusrex:",
":trynottocry:",
":westworld:",
":heavy-breathing:",
":car-t-rex:",
":data-corn:",
":pho:",
":phosho:",
":sriracha:",
":strangemuisc:",
":riffraff:",
":triangle:",
":overachiever:",
":bagel:",
":wonder-woman:",
":limabean:",
":leon:",
":tyrone:",
":jordan:",
":fucc:",
":harambeharambe:",
":mongo:",
":bitcoin:",
":tensorflow:",
":angry-google:",
":chinese_takeout:",
":unicode:",
":rubberducky:",
":paulo:",
":radiohead:",
":greyson:",
":mannequin:",
":snoop_dog:",
":ateam:",
":python:",
":trigggered:",
":prtg:",
":zombie_walking:",
":lego-smile:",
":lego-wink:",
":totoro:",
":bouncytotoro:",
":orca:",
":parrotbeer:",
":skiparrot:",
":shipitparrot:",
":nickkopp:",
":terraform:",
":disgust:",
":veggiegrinder:",
":trogdor:",
":ginger:",
":surprise_blinking:",
":business-cat:",
":rollo:",
":hackday:",
":hands:",
":cashmeousside:",
":maxine:",
":luna:",
":maxine2:",
":greyjoy:",
":hikevin:",
":hal:",
":handsss:",
":matt_damon:",
":celery:",
":samoa:",
":pi:",
":gonzaga:",
":pdf:",
":buppetaboppeta:",
":no_dice:",
":fire_extinguisher:",
":kevinsayshi:",
":redis:",
":minion:",
":catdog:",
":guyyy:",
":henny:",
":hichews:",
":clustering:",
":regression:",
":iisreset:",
":trashteam:",
":insightdown:",
":excitedkevin:",
":epic-sax-guy:",
":dumpsterfire:",
":badpundog:",
":celeryman:",
":gudetama:",
":itsalice:",
":java:",
":merylsayshi:",
":sautbot:",
":smokey:",
":dwight:",
":tired:",
":lean:",
":leannn:",
":babyyyy:",
":coughing:",
":stare:",
":curling:",
":slacker:",
":ravioli:",
":tats:",
":shank:",
":gong:",
":kontinuum:",
":waiting:",
":padthai:",
":nicki:",
":soundersfc:",
":goatthuglife:",
":docker:",
":hypnotoad:",
":babygiraffe:",
":pocket_aces:",
":cherponyta:",
":sparklyhippo:",
":wsop:",
":wsop_stack:",
":tableflip:",
":snoopywoodstock:",
":ayyy:",
":vader:",
":pogue-squadron:",
":evil-kermit:",
":thunderbirds:",
":randy-savage:",
":wog:",
":rolltide:",
":jeffrey:",
":allenthetroll:",
":mops:",
":cal:",
":violin_tiny:",
":cbtgif:",
":rockies:",
":plusone:",
":kermit:",
":partydino:",
":texas:",
":soundgarden:",
":mountain_dew:",
":lying:",
":cookiemonster:",
":aww-yiss:",
":tropicalkev:",
":jaden:",
":gregg:",
":gummybear:",
":partywizard:",
":stephencurry:",
":florida:",
":covfefe:",
":audrey2:",
":james_bond:",
":ariwatchingtheworldburn:",
":evilsa_bot:",
":whiterussian:",
":klay:",
":calvinandhobbs:",
":payscalien-charlie:",
":payscalien-conor:",
":payscalien-brian:",
":payscalien-flair:",
":payscalien-isaac:",
":payscalien-jason:",
":payscalien-jesse:",
":payscalien-mike:",
":payscalien-nick:",
":payscalien-scott:",
":payscalien-tayler:",
":betterghost:",
":averagejoes:",
":waldo:",
":bat-gasp:",
":murph:",
":minnie:",
":cartmanauthoritah:",
":yoga:",
":sautlessinseattle:",
":toof:",
":toof_is_sad:",
":kappa:",
":ohhh:",
":pxl:",
":hug:",
":letsplay:",
":wow:",
":buggy:",
":bye_boo:",
":cool_beans:",
":heres_johnny:",
":live_long_and_prosper:",
":chili:",
":bbb:",
":soundcloud:",
":falling:",
":thepowerisyours:",
":whitewine:",
":chili_hat:",
":data-science:",
":nauseated:",
":savenetneutrality:",
":jansen:",
":macaron:",
":gatekeeper:",
":finnmoji:",
":footballfinn:",
":finnrushmore:",
":jason-bourne:",
":nuke:",
":judy:",
":cher:",
":mac:",
":aaa:",
":bb:",
":ccc:",
":ddd:",
":eee:",
":fff:",
":ggg:",
":hhh:",
":iii:",
":jjj:",
":kk:",
":mm:",
":nnn:",
":ttt:",
":oo:",
":ppp:",
":qqq:",
":rrr:",
":sss:",
":uuu:",
":vvv:",
":www:",
":xx:",
":yyy:",
":zz:",
":pickle2:",
":dancingpanda:",
":doge3d:",
":eazye:",
":fidget:",
":thonkingggg:",
":boiii:",
":chatdead:",
":avs:",
":emokid:",
":headbangg:",
":monkeyy:",
":captain:",
":flamingo:",
":awyeahhh:",
":ayylmao:",
":greenman:",
":killua:",
":killua2:",
":gon:",
":buoy:",
":gon2:",
":underachiever:",
":achiever:",
":bane:",
":hamburgler:",
":broom:",
":thou_shall_not_pass:",
":angryjeff:",
":gavin_belson:",
":kick_off:",
":niagara_falls:",
":fake-corey:",
":tom:",
":shawn:",
":total_eclipse:",
":vinyl:",
":green-weenie:",
":not-galen:",
":verified:",
":frenchie:",
":fnlfinn:",
":gold:",
":kentucky:",
":einstein:",
":frustrated:",
":upload_cat:",
":effort:",
":phonebooth:",
":target90:",
":sj:",
":peanut:",
":fishbulb:",
":mr-sparkle:",
":soss:",
":reggi:",
":dancingpoop:",
":hops:",
":redskins:",
":krang:",
":seahawks_logo2:",
":seahawks76:",
":waffle:",
":gotomeeting:",
":narutorun:",
":steelers:",
":sharks:",
":the_dude:",
":rickrolled:",
":shrug_woman:",
":shrug_man:",
":rainboots:",
":payscale-it:",
":hulkhogan:",
":stealie:",
":jerryhand:",
":treyface:",
":bing:",
":skoal:",
":dumpling_bun:",
":potsticker:",
":noodles:",
":moneyoooh:",
":plumbus:",
":picklerick:",
":rick1:",
":rick2:",
":morty2:",
":morty:",
":breakerofbuilds:",
":literally-the-worst:",
":cowboykent:",
":shrek:",
":beard:",
":sj2:",
":coloradoflag:",
":litehouse:",
":cors:",
":stressed:",
":newjersey:",
":derezzed:",
":newjeff:",
":workingjeff:",
":rocco:",
":gracie:",
":yankees:",
":shame:",
":rimshot:",
":tuba:",
":joe:",
":jazz:",
":goodtimes2:",
":shots:",
":musclemanchild:",
":macho:",
":griswold:",
":clarkwgriswold:",
":itsjustoneofthosedays:",
":flavortown:",
":cowboyjeff:",
":autobots:",
":transformers:",
":rum:",
":djcher:",
":ghostbusters:",
":hamieldyseni:",
":cage:",
":raney:",
":garret:",
":stiemert:",
":wreath:",
":d20:",
":whip:",
":columbuscow:",
":5hourenergy:",
":bunnies:",
":binary:",
":metzger:",
":osprey:",
":jitterbug:",
":elf_movie:",
":black_panther:",
":snuggie:",
":sadtree:",
":shruggo:",
":bflmc:",
":back_away:",
":roll-safe:",
":guitarcenter:",
":tails:",
":leslieknope:",
":playscale:",
":aggies:",
":christmasminnie:",
":christmasmickey:",
":grumpybaby:",
":bey:",
":grinch:",
":jira:",
":atlassian:",
":rockbottomwes:",
":pongspence:",
":metropolitans:",
":porg:",
":mugs:",
":okta:",
":kubernetes:",
":liverpool:",
":gilbert:",
":yipyip:",
":nopenope:",
":vikings:",
":sonics:",
":crushit:",
":cupcake:",
":wendys:",
":jail:",
":disneygrimace:",
":disneysob:",
":disneyrage:",
":disneylol:",
":vacationchanta:",
":xander:",
":snowshoe:",
":snowshoeing:",
":louisvillepuretap:",
":snowtubing:",
":maxine3:",
":maxine4:",
":maxine5:",
":penguins:",
":bonsai:",
":marshmallowsdarkchocolate:",
":lanch:",
":neo:",
":btc:",
":eth:",
":ltc:",
":qtum:",
":xmr:",
":zen:",
":nebl:",
":omg:",
":miota:",
":xrp:",
":nem:",
":ada:",
":xlm:",
":rep:",
":gnt:",
":hodl:",
":mooning:",
":tropicthunder:",
":icx:",
":xrb:",
":etc:",
":bnb:",
":wtc:",
":ark:",
":adex:",
":storj:",
":lambo:",
":lambo2:",
":lambologo:",
":emergenc:",
":roary:",
":roary-portrait:",
":nightowl:",
":be-excellent-to-each-other:",
":party-on-dude:",
":tegile:",
":accenture:",
":watchguardmobilevpn:",
":coffeestarbucks:",
":tea2:",
":gluten-free:",
":gluten-free2:",
":pong:",
":pup:",
":j_wellington_wimpy:",
":zebra:",
":tyler:",
":zebra_cake:",
":derp:",
":mahalo:",
":redwheelcdat:",
":sautlet:",
":ela:",
":mardi_gras_mask:",
":great_lakes:",
":sjsjsj:",
":olympics:",
":crossedwires:",
":lambo3:",
":hamilton:",
":trumpoop:",
":fidgetparty:",
":dealwithit:",
":laugh_cry_party:",
":partycorgi:",
":partyfrog:",
":cry_rainbow_tears:",
":chad_friend:",
":chad_bogues:",
":chris_dewan:",
":banhmi:",
":slippery_when_wet:",
":goldfish:",
":centurylink:",
":tax_man:",
":nj:",
":crushingit:",
":dialup:",
":migrate:",
":hypno_spiral:",
":racing:",
":sherman_frenchie:",
":boris:",
":kitkat:",
":grouch:",
":oscar:",
":cattyping:",
":ichiro:",
":pugrainbow:",
":jazz_hands:",
":bender:",
":chaddolla:",
":meow_orange_tabby:",
":meow_cool_kitten:",
":sadkent:",
":lobster:",
":renee:",
":dragonball:",
":vegeta:",
":bking:",
":disneyland:",
":mickeyears:",
":ernie_approves:",
":gunner:",
":gunner2:",
":pugsplosion:",
":finn:",
":finn2:",
":pugparty:",
":sandbaggin:",
":just-do-it:",
":sandbag:",
":dillydilly:",
":dilly:",
":grey:",
":oldskool:",
":sea:",
":turkcayi:",
":chadmodel:",
":cosmos:",
":croc_shoe:",
":banti:",
":dansgame:",
":lul:",
":wutface:",
":approved:",
":lacrosse:",
":spruce:",
":stanleycup:",
":sadmac:",
":happymac:",
":moon-photo:",
":lunatom:",
":science:",
":google:",
":ubuntu:",
":vscode:",
":wifi:",
":angelslogo:",
":elastic:",
":bob_belcher_nope:",
":racoon:",
":notgucci:",
":ringo:",
":shaka:",
":overwatch:",
":caps:",
":rari:",
":ravencoin:",
":notlikethis:",
":upvote:",
":downvote:",
":rip:",
":x_wing:",
":serenitynow:",
":catlilbub:",
":pagchomp:",
":redbull_nosuger:",
":redbull_nosuger2:",
":brokenrecord:",
":meeple:",
":abacus_:",
":abacus:",
":esteban-pride:",
":space_needle:",
":capitals:",
":cary:",
":second_scruffy:",
":dilbert:",
":roseallday:",
":ihavethepower:",
":blues_clues:",
":jake:",
":thatsthejoke:",
":birks:",
":have_you_tried:",
":beau:",
":aspen_gunner:",
":cyberman:",
":beau2:",
":sloth:",
":cdatsad:"
)




$emojiLength = $emojis.length-1
#$currentEmoji = ":payscale-it:"

function checkTime{
if($currentTime -eq "0600"){
Send-SlackMessage "Goodmorning Payscale IT" -Channel "#account-lockouts"
}
if($currentTime -eq "1905"){
Send-SlackMessage "Goodnight" -Channel "#account-lockouts"
}
else{
}
}

function checkLocked{
if($script:lockedUsers){
    foreach($user in $script:lockedUsers){
        if(test-path "\\filer02\IT\zz_aconstantino\LockedOutFiles\$user.txt"){
            $lockTime = gc "\\filer02\IT\zz_aconstantino\LockedOutFiles\$user.txt"
            $checkTime = (get-date).AddMinutes(-9).ToString("HHmm")
                if(($lockTime -lt $checkTime) -and ($checkTime % 13 -eq 0)){
                    if($locktime -gt "1259"){
                        $twelveHourLockTime = $locktime - 1200
                        $string = $twelveHourLockTime.ToString()
                        $writeTime = $string[0]+":"+$string[1]+$string[2]
                        Send-SlackMessage "$user is still locked out! -- $writeTime" -Channel "#account-lockouts"
                        }
                    if(($locktime -le "1259") -and ($locktime -gt "0959")){
                        $string = $lockTime.ToString()
                        $writeTime = $string[0]+$string[1]+":"+$string[2]+$string[3]
                        Send-SlackMessage "$user is still locked out! -- $writeTime" -Channel "#account-lockouts"
                        }
                    if(($lockTime -gt "0559") -and ($lockTime -le "0959")){
                        $string = $lockTime.ToString()
                        $writeTime = $string[1]+":"+$string[2]+$string[3]
                        Send-SlackMessage "$user is still locked out! -- $writeTime" -Channel "#account-lockouts"
                        }
                        else{
                        #Send-SlackMessage "In the Else and you shouldn't be -- Locktime: $locktime" -Channel "#account-lockouts"
                        }
                } #end check time if
                else{
                }
            } #end test if

        else{
            $log = Get-EventLog -computername HQAD03 -LogName Security -InstanceId 4740 -Message "*$user*" -Newest 1 | fl -Property Message | out-string
            $computer = ($log -split "Name",4)[3]
            $count = $computer | measure -Character -IgnoreWhiteSpace | select Characters -ExpandProperty characters
            
            #$pos = $log.IndexOf("Name",420)
            #$right = $log.substring($pos+1)
            #$computer = $right -replace '\s',''
            $i = Get-Random -Minimum 0 -Maximum $emojiLength
            $emoji = $emojis[$i]
            Out-File -FilePath "\\filer02\IT\zz_aconstantino\LockedOutFiles\$user.txt" -InputObject $currentTime
                if(($computer -eq ":") -or ($computer -eq $null) -or ($count -eq 1)){
                    Send-SlackMessage "$user is locked out! $emoji -- No machine name in event log" -Channel "#account-lockouts"
                    #Send-SlackMessage "$user is locked out! $currentEmoji -- No machine name in event log" -Channel "#account-lockouts"
                    }
                    else{
                    Send-SlackMessage "$user is locked out! $emoji -- Check machine name$computer" -Channel "#account-lockouts"
                    #Send-SlackMessage "$user is locked out! $currentEmoji -- Check machine n$computer" -Channel "#account-lockouts"
                    }
            }#end else
        } #end foreach
}

else{
Remove-Item "\\filer02\IT\zz_aconstantino\LockedOutFiles\*"

}
}

checkTime
checkLocked